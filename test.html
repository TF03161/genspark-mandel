<!DOCTYPE html>
<html>
<head>
    <title>Test Mandelbulb</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
    <style>
        body { margin: 0; overflow: hidden; background: #000; }
    </style>
</head>
<body>
    <script>
        let angle = 0;
        
        function setup() {
            createCanvas(windowWidth, windowHeight, WEBGL);
            colorMode(HSB, 360, 100, 100);
        }
        
        function draw() {
            background(0);
            
            // Simple rotating Mandelbulb visualization
            angle += 0.01;
            rotateY(angle);
            rotateX(angle * 0.7);
            
            // Lighting
            ambientLight(200, 20, 50);
            pointLight(180, 80, 100, 200, 0, 0);
            
            // Draw Mandelbulb points
            strokeWeight(2);
            for (let theta = 0; theta < PI; theta += PI/20) {
                for (let phi = 0; phi < TWO_PI; phi += PI/10) {
                    let r = 1.5;
                    let x = r * sin(theta) * cos(phi);
                    let y = r * sin(theta) * sin(phi);
                    let z = r * cos(theta);
                    
                    // Simple Mandelbulb check
                    if (isMandelbulb(x, y, z)) {
                        push();
                        translate(x * 100, y * 100, z * 100);
                        
                        let hue = (theta * 57 + phi * 28 + frameCount * 0.5) % 360;
                        fill(hue, 80, 90);
                        noStroke();
                        sphere(3);
                        pop();
                    }
                }
            }
        }
        
        function isMandelbulb(x, y, z) {
            let zx = x, zy = y, zz = z;
            let r = 0;
            let power = 8;
            
            for (let i = 0; i < 8; i++) {
                r = sqrt(zx*zx + zy*zy + zz*zz);
                if (r > 2) return false;
                
                let theta = atan2(sqrt(zx*zx + zy*zy), zz);
                let phi = atan2(zy, zx);
                
                let rn = pow(r, power);
                theta *= power;
                phi *= power;
                
                zx = rn * sin(theta) * cos(phi) + x;
                zy = rn * sin(theta) * sin(phi) + y;
                zz = rn * cos(theta) + z;
            }
            return true;
        }
        
        function windowResized() {
            resizeCanvas(windowWidth, windowHeight);
        }
    </script>
</body>
</html>